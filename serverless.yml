useDotenv: true

service: openai-api-apps
frameworkVersion: "3"
provider:
  name: aws
  stage: dev
  region: ap-northeast-1
  runtime: nodejs18.x

package:
  patterns:
    - "!**"
    - ".output/**"
    - "infra/functions/authorizer.js"

functions:
  NuxtSsrEngine:
    handler: ".output/server/index.handler"
    environment:
      AUTH_USERNAME: ${env:AUTH_USERNAME}
      AUTH_PASSWORD: ${env:AUTH_PASSWORD}
      DB_URL: ${env:DB_URL}
    events:
      - httpApi:
          method: any
          path: /
      - httpApi:
          method: any
          path: /{proxy+}
